local Players = game:GetService("Players")
local plr = Players.LocalPlayer

-- Create ScreenGui
local screengui = Instance.new("ScreenGui")
screengui.Name = "TurquoizViewer"
screengui.ResetOnSpawn = false
screengui.IgnoreGuiInset = true
screengui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
screengui.Parent = plr:WaitForChild("PlayerGui")

-- Create main ScrollingFrame
local scrollingframe = Instance.new("ScrollingFrame")
scrollingframe.Name = "ViewerFrame"
scrollingframe.Parent = screengui
scrollingframe.Size = UDim2.new(0.15, 0, 0.25, 0)
scrollingframe.Position = UDim2.new(0.35, 0, 0.25, 0)
scrollingframe.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
scrollingframe.BackgroundTransparency = 0.1
scrollingframe.BorderSizePixel = 0
scrollingframe.ScrollBarThickness = 8
scrollingframe.AutomaticCanvasSize = Enum.AutomaticSize.Y
scrollingframe.ScrollingDirection = Enum.ScrollingDirection.Y
scrollingframe.ScrollBarImageColor3 = Color3.fromRGB(0, 170, 255)
scrollingframe.ScrollBarImageTransparency = 0.3

-- Add a UIDragDetector to allow native frame dragging
local dragDetector = Instance.new("UIDragDetector")
dragDetector.Parent = scrollingframe

-- Create a rounded corner
local corner = Instance.new("UICorner")
corner.CornerRadius = UDim.new(0, 8)
corner.Parent = scrollingframe

-- Function to get character and HRP
local function getCharacter(targetPlayer)
	local char = targetPlayer.Character or targetPlayer.CharacterAdded:Wait()
	local hrp = char:FindFirstChild("HumanoidRootPart") or char:WaitForChild("HumanoidRootPart", 10)
	return char, hrp
end

-- Function to create a teleport button for a player
local function createPlayerButton(parent, targetPlayer)
	local button = Instance.new("TextButton")
	button.Name = targetPlayer.Name
	button.Text = targetPlayer.DisplayName .. " (" .. targetPlayer.Name .. ")"
	button.Size = UDim2.new(1, -10, 0, 30)
	button.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
	button.TextColor3 = Color3.fromRGB(255, 255, 255)
	button.Font = Enum.Font.SourceSansBold
	button.TextSize = 18
	button.BorderSizePixel = 0
	button.Parent = parent

	button.MouseButton1Click:Connect(function()
		local _, targetHrp = getCharacter(targetPlayer)
		local _, myHrp = getCharacter(plr)

		if targetHrp and myHrp then
			myHrp.CFrame = targetHrp.CFrame + Vector3.new(0, 3, 0)
		else
			warn("Could not teleport â€” missing HRP for one of the players.")
		end
	end)
end

-- Function to refresh player list
local function refreshPlayerList()
	scrollingframe:ClearAllChildren()

	local layout = Instance.new("UIListLayout")
	layout.Padding = UDim.new(0, 4)
	layout.FillDirection = Enum.FillDirection.Vertical
	layout.SortOrder = Enum.SortOrder.LayoutOrder
	layout.Parent = scrollingframe

	for _, p in ipairs(Players:GetPlayers()) do
		if p ~= plr then
			createPlayerButton(scrollingframe, p)
		end
	end
end

-- Initial population
refreshPlayerList()

-- Auto-refresh when players join/leave
Players.PlayerAdded:Connect(refreshPlayerList)
Players.PlayerRemoving:Connect(refreshPlayerList)
